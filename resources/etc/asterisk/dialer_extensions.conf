[test_call]
exten => _X.,1,Dial(SIP/zadarma/${EXTEN})
[internal]
exten => +447723009808,1,Dial(SIP/104.196.193.91/021001447480064990)
exten => +447723009808,n,Dial(SIP/104.196.193.91/021001447407314630)
exten => +443330068539,1,Dial(SIP/104.196.193.91/021001601131095593)
exten => 601131095593,1,Dial(SIP/104.196.193.91/021001601131095593)
exten => 1122,1,Dial(SIP/104.196.193.91/021001443330068539)

exten => 442080897287,1,noop(-----${CALLERID(num)}-----)
exten => 442080897287,n,Playback(/var/lib/asterisk/sounds/asterisk-audio-1)
exten => 442080897287,n,Set(CALLERID(num)=${CALLERID(num)})
exten => 442080897287,n,Set(userId=4104)
exten => 442080897287,n,Set(sip_id=4104)
exten => 442080897287,n,noop(---userid-${userId}---)
exten => 442080897287,n,noop(---sip_id---${sip_id}---)
exten => 442080897287,n,Queue(1)
;exten => 442080897287,n,Dial(SIP/166156,30)
;exten => 442080897287,n,Dial(SIP/624919)
exten => 442080897287,n,Goto(s-${DIALSTATUS},1)
exten => s-CANCEL,1,playback(/var/lib/asterisk/sounds/ivr-busy)
exten => s-CANCEL,n,Dial(SIP/166156i,60)
exten => s-NOANSWER,1,Set(DTIME=$[${EPOCH} - ${DIALSTART}])
exten => s-NOANSWER,n,playback(/var/lib/asterisk/sounds/ivr-busy)
exten => s-NOANSWER,n,Dial(SIP/166156,60)
exten => s-BUSY,n,playback(/var/lib/asterisk/sounds/ivr-busy)
exten => s-BUSY,n,Dial(SIP/166156,60)
exten => s-CHANUNAVAIL,1,Verbose(1,Need failover for "${ARG1}")
exten => s-CHANUNAVAIL,n,playback(/var/lib/asterisk/sounds/out)
exten => s-CHANUNAVAIL,n,Dial(SIP/166156,60)
exten => s-CONGESTION,1,Congestion
exten => s-CONGESTION,n,playback(/var/lib/asterisk/sounds/ivr-busy)
exten => s-CONGESTION,n,Dial(SIP/166156,60)


[trunkSelection]
exten => _X.,1,Noop(number : ${EXTEN}, user : ${CHANNEL(peername)})
same => n,Set(ARRAY(__trunk,__prefix)=voxbeam,)
;same => n,ExecIf($[${EXTEN:0:2}!=44]?Set(ARRAY(__trunk,__prefix)=didcomm,00088))
same => n,ExecIf($[${EXTEN:0:2}!=44]?Set(ARRAY(__trunk,__prefix)=NET2-CALL,00))
;same => n,ExecIf($[${EXTEN:0:2}!=44]?Set(ARRAY(__trunk,__prefix)=104.196.193.91,021001))
;same => n,ExecIf($[${EXTEN:0:2}=44]?Set(ARRAY(__trunk,__prefix)=didcomm,00088):Set(ARRAY(__trunk,__prefix)=${trunk},${prefix}))
;same => n,ExecIf($[${EXTEN:0:2}=44]?Set(ARRAY(__trunk,__prefix)=mycountrymobile,26842):Set(ARRAY(__trunk,__prefix)=${trunk},${prefix}))
;same => n,ExecIf($[${EXTEN:0:2}=44]?Set(ARRAY(__trunk,__prefix)=iconglobal,):Set(ARRAY(__trunk,__prefix)=${trunk},${prefix}))
same => n,ExecIf($[${EXTEN:0:2}=44]?Set(ARRAY(__trunk,__prefix)=NET2-CALL,00):Set(ARRAY(__trunk,__prefix)=${trunk},${prefix}))
same => n,ExecIf($[${EXTEN:0:2}=60]?Set(ARRAY(__trunk,__prefix)=NET2-CALL,00):Set(ARRAY(__trunk,__prefix)=${trunk},${prefix}))
same => n,ExecIf($[${EXTEN:0:1}=1]?Set(ARRAY(__trunk,__prefix)=NET2-CALL):Set(ARRAY(__trunk,__prefix)=${trunk},${prefix}))
same => n,ExecIf($[${EXTEN:0:2}=91]?Set(ARRAY(__trunk,__prefix)=NET2-CALL):Set(ARRAY(__trunk,__prefix)=${trunk},${prefix}))
same => n,ExecIf($[${EXTEN:0:2}=65]?Set(ARRAY(__trunk,__prefix)=NET2-CALL):Set(ARRAY(__trunk,__prefix)=${trunk},${prefix}))


;same => n,ExecIf($[${CHANNEL(peername)}=319454]?Set(ARRAY(__trunk,__prefix)=104.196.193.91,021001):Set(ARRAY(__trunk,__prefix)=${trunk},${prefix}))
same => n,Return

[flood_dialout]
exten => _X.,1,Noop(call_flood)
same => n,Set(CALLERID(num)=447${RAND(3,8)}${RAND(10000000,51474834)})
same => n,Dial(SIP/voxbeam/${EXTEN})
same => n,Hangup

[flood_answer]
exten => 999,1,Hangup

[otpDial]
exten => _X.,1,Noop( uniqueid : ${uniqueId}, userid : ${userId})
same => n,Set(ARRAY(__spoofBalance)=${ODBC_Check_Balance(${userId})})
same => n,GotoIf($[${spoofBalance} < 1]?no_balance)
same => n,Set(limit=L(${MATH(${spoofBalance}*60,i)}000))
same => n,Set(CALLERID(num)=${callerid})
same => n,Set(__uniqueid=${uniqueId})
same => n,Set(CHANNEL(accountcode)=${uniqueid})
same => n,Set(__callId=${CALLERID(num)})
same => n,Set(__destination=${EXTEN})
same => n,Set(__Company=${companyName})
same => n,Set(__securityCode1=${otpSecurityCode})
same => n,Set(__otpSecurityCodeFile=${otpSecurityCodeFile})
same => n,Set(CHANNEL(hangup_handler_push)=dialout_handler,s,1())
same => n,Set(__callType=otp)
same => n,Set(__billingField=otp_time)
same => n,Set(__callStartTime=${STRFTIME(${EPOCH},,%Y-%m-%d %H:%M:%S)})
same => n,Set(GROUP()=otpDial)
same => n,Noop(Number of active calls ######   ${GROUP_COUNT(otpDial)}    #######)
same => n,Set(ODBC_pushLiveReportsOtp(${destination},${CALLERID(num)},"${uniqueid}",${userId})=writestatus)
same => n,Set(__recorded_file=${EXTEN}-${callId}-${uniqueid}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)})
same => n,GoSub(trunkSelection,${EXTEN},1)
same => n,GotoIf($[${EXTEN} = 601131095593]?dial2:dial)
same => n(dial2),Dial(SIP/1264830897,,U(otp_answer_handler,s,1))
same => n(dial),Dial(SIP/${trunk}/${prefix}${EXTEN},,U(otp_answer_handler,s,1))
;same => n,GotoIf($[${EXTEN} = 919747314989]?:dial)
;same => n,Dial(SIP/voxbeam/${EXTEN},,U(otp_answer_handler,s,1))
;same => n,Dial(SIP/104.196.193.91/021001${EXTEN},,U(otp_answer_handler,s,1))
;same => n,Gotoif($[${EXTEN:5} = "44345"]?idt:dial)
;same => n,GotoIf($[${EXTEN} = 212707199007]?dial:)
;same => n,GotoIf($[$["${EXTEN:0:5}" = "44345"] | $["${EXTEN:0:3}" = "212"] | $["${EXTEN:0:4}" = "2126"]]?idt:dial)
;same => n,GotoIf($[$["${EXTEN:0:5}" = "44345"]?idt:dial)
;same => n,GotoIf($["${EXTEN:0:5}" = "44345"]?idt:dial)
;same =>  n,GotoIf($["${EXTEN:0:5}" = "44345"]?idt:dial)
;same => n(dial),Dial(SIP/voip_traffic/${EXTEN},,U(otp_answer_handler,s,1))
;same => n(dial),Dial(SIP/didlogic/${EXTEN},,U(otp_answer_handler,s,1))
;same => n(idt),Dial(SIP/didlogic/${EXTEN},,${limit}U(answer_handler,s,1))
;same => n(dial1),Dial(SIP/58378/555331${EXTEN},,U(dialer_answer_handler,s,1))
same => n,Noop(${DIALSTATUS})
;same => n,Hangup
same => n(dial),Dial(SIP/Bridge_Voice/${EXTEN},,U(otp_answer_handler,s,1))
;same => n,Dial(SIP/idt/${EXTEN},,U(otp_answer_handler,s,1))
same => n,Noop(${DIALSTATUS})
;same => n,Hangup
;same => n(dial),Dial(SIP/${trunk}/${prefix}${EXTEN},,U(otp_answer_handler,s,1))
;same => n(dial),Dial(SIP/104.196.193.91/021001${EXTEN},,U(otp_answer_handler,s,1))
;same => n(dial),Dial(SIP/voip_traffic/${EXTEN},,U(otp_answer_handler,s,1))
same => n,Dial(SIP/didlogic/${EXTEN},,U(otp_answer_handler,s,1))
same => n,Hangup
same => n(no_balance),Hangup

[otp_answer_handler]
exten => s,1,Noop(uniqueid : ${UNIQUEID})
;updateLiveReportsOtp : uniqueid , otp status, call status
same => n,Set(ODBC_updateLiveReportsOtp(${uniqueid},3,2)=writestatus)
same => n(return),Return()


[web-dial]
exten => _X.,1,Answer()
same => n,Set(ARRAY(__userId)=${ODBC_GetUserIdWebPhone(${CHANNEL(peername)})})
same => n,Goto(direct-dial,${EXTEN},1)
same => n,Hangup

[direct-dial]
exten => **X.,1,Dial(SIP/voip_traffic/${EXTEN:2})

exten => ****X.,1,Set(CALLERID(num)=${CALLERID(name)})
exten => ****X.,n,Dial(SIP/58378/555331${EXTEN}

exten => _*7X.,1,Set(CALLERID(num)=${CALLERID(name)})
exten => _*7X.,n,Dial(SIP/mysipp/00${EXTEN:2})


exten => _*8X.,1,Set(CALLERID(num)=${CALLERID(name)})
exten => _*8X.,n,Dial(SIP/didlogic/${EXTEN:2})

exten => ***111,1,set(lang=uk)
exten => ***111,n,Set(welcomeAudio=automated_call)
exten => ***111,n,Set(ivrType=transaction)
exten => ***111,n,Goto(ivr-start,111,1)

exten => *5111,1,set(lang=uk)
exten => *5111,n,Set(welcomeAudio=automated_call)
exten => *5111,n,Set(securityCode=5)
exten => *5111,n,Goto(telepin,dtmf,1)

exten => 6000,1,Playback(ivr/usa/automated_call)
same => n,Playback(ivr/usa/thank_you_confirm)
same => n,Playback(ivr/usa/thank_you_for_confirming)
same => n,Hangup

exten => 314989,1,Dial(SIP/${EXTEN})
same => n,Hangup
;exten => _1X.,1,Set(CALLERID(num)=${CALLERID(name)})
;exten => _1X.,n,Noop(---${CALLERID(num)}--)
;exten => _1X.,n,Dial(SIP/zadarma/${EXTEN:1})
exten => 123456789,1,Noop()
;same => n,Answer()
same => n,GoSub(trunkSelection,${EXTEN},1)
same => n,Set(CALLERID(num)=918764982873)
same => n,Dial(SIP/${trunk}/${prefix}919747314989)
;same => n,Answer()
;same => n,Echo()
same => n,Hangup

exten => 6000,1,Answer
exten => 6000,2,MusicOnHold(barc)
same => n,Hangup


exten => _XXXXX,1,Noop()
same => n,Goto(voice_recognition_dial,${EXTEN},1)
same => n,Hangup

exten => _XXXXXX,1,Noop()
same => n,Goto(voice_recognition_dial,${EXTEN},1)
same => n,Hangup

exten => _X.,1,Noop(callerid name : ${CALLERID(name)}, callerid number : ${CALLERID(num)}, uniqueid : ${UNIQUEID}, user : ${CHANNEL(peername)})
;same => n,Set(__DYNAMIC_FEATURES=hsbc#barcley#santander#natwest#natwest#tesco#metro#jp_morgan#halifax#cooperative#lloyds#tsb#yorkshire#clydesdale#ulster#bank_of_scotland#cater_allen#coutts#danske#mns#virgin#barclaycard#sainsburys#mbna#aqua#luma#creation#post_office#marbles#john_lewis#american_express)
same => n,Set(__DYNAMIC_FEATURES=hsbc#barcley#santander)
same => n,GotoIf(${ISNULL(${userId})}?:checkBalance)
same => n,Set(ARRAY(__userId)=${ODBC_GetUserId(${CHANNEL(peername)})})
same => n,GotoIf(${ISNULL(${userId})}?hang)
same => n(checkBalance),Set(ARRAY(__spoofBalance)=${ODBC_Check_Balance(${userId})})
same => n,GotoIf($[${spoofBalance} < 1]?no_balance)
;same => n,Set(ARRAY(__subscriptionEndDate)=${ODBC_Check_Subscription(${userId})})
;same => n,GotoIf(${ISNULL(${subscriptionEndDate})}?subscriptionEnded)
;same => n,Set(subscriptionEndDateEpoch=${STRPTIME(${subscriptionEndDate},,%Y-%m-%d %H:%M:%S)})
;same => n,Set(currentTime=${STRFTIME(${EPOCH},,%s)})
;same => n,set(timeDiff=$[${subscriptionEndDateEpoch} - ${currentTime}])
;same => n,GotoIf($[${timeDiff}<0]?subscriptionEnded)
same => n,Set(limit=L(${MATH(${spoofBalance}*1,i)}000))
;same => n,Set(limit=L${spoofBalance})
same => n,Set(__uniqueid=${UNIQUEID})
same => n,Set(CHANNEL(accountcode)=${UNIQUEID})
same => n,Set(__callId=${CALLERID(name)})
same => n,Set(__destination=${EXTEN})
same => n,Set(CALLERID(num)=${CALLERID(name)})
same => n,Set(CALLERID(name)=Sanjeet)
;same => n,Set(ARRAY(__pitch)=${ODBC_GetPitch(${uniqueid})})
;same => n,Set(pitch=0.1)
;same => n,Set(PITCH_SHIFT(rx)=${pitch})
same => n,Set(CHANNEL(hangup_handler_push)=dialout_handler,s,1())
same => n,Set(__callStartTime=${STRFTIME(${EPOCH},,%Y-%m-%d %H:%M:%S)})
same => n,Set(GROUP()=dialout)
same => n,Noop(Number of active calls ######   ${GROUP_COUNT(dialout)}    #######)
same => n,Set(ODBC_pushLiveReports(${destination},${CALLERID(num)},"${uniqueid}",${userId})=writestatus)
same => n,Set(__recorded_file=${EXTEN}-${callId}-${uniqueid}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)})
;same => n,GoSub(trunkSelection,${EXTEN},1)
;same => n,Dial(SIP/${trunk}/${prefix}${EXTEN},,${limit}U(answer_handler,s,1))
same => n,Set(CHANNEL(musicclass)=barcley)
;same => n,GotoIf($[${EXTEN} = 919747314989]?:dial)
;same => n,GotoIf($["${EXTEN:0:4}" = "2127"]?dial:con)
same => n,noop(---${EXTEN:0:5}----)
;same => n,GotoIf($[$[{EXTEN:0:5} = "44345"] || $["${EXTEN:0:3}" = "212"]?idt:dial)
;same => n,GotoIf($[${EXTEN:0:4} = 2127 | $[${EXTEN:0:4} = 2126]?dial:con)
;same => n(con),GotoIf($[$["${EXTEN:0:5}" = "44345"] | $["${EXTEN:0:3}" = "212"]]?idt:dial)
;same => n(con),GotoIf($[$["${EXTEN:0:5}" = "44345"]]?idt:dial)
;same => n(con),GotoIf($[$["${EXTEN:0:5}" = "44345" | $["${EXTEN:0:2}" = "43"]]?idt:dial)
same => n,noop(----${CALLERID(num)}-----)
same => n,GotoIf($[$["${CALLERID(num):0:5}" = "44800"] | $["${CALLERID(num):0:5}" = "44808"]]?block:con)
same => n(block),Dial(SIP/mysipp/00${EXTEN},,${limit}U(answer_handler,s,1))
same => n(con),GotoIf($["${EXTEN:0:5}" = "44345"]?idt:dial)
;same => n(idt),Dial(SIP/idt/99904${EXTEN},,${limit}U(answer_handler,s,1))
;same => n(idt),Dial(SIP/didlogic/${EXTEN},,${limit}U(answer_handler,s,1))
same => n(idt),Dial(SIP/mysipp/00${EXTEN},,${limit}U(answer_handler,s,1))
;same => n(dial),Dial(SIP/voip_traffic/${EXTEN},,${limit}U(answer_handler,s,1))
same => n(dial),Dial(SIP/didlogic/${EXTEN},,${limit}U(answer_handler,s,1))
;same => n(dial),Dial(SIP/mysipp/00${EXTEN},,${limit}U(answer_handler,s,1))
same => n,Noop(${DIALSTATUS})
same => n,GotoIf($[${DIALSTATUS} = ANSWER]?hang)

;same => n,Dial(SIP/didlogic/${EXTEN},,${limit}U(answer_handler,s,1))
same => n,Noop(${DIALSTATUS})
;same => n,GotoIf($[$["${CALLERID(num):0:5}" = "44800"] | $["${CALLERID(num):0:5}" = "44808"]]?block:con)
same => n,Dial(SIP/Bridge_Voice/2222${EXTEN},,${limit}U(answer_handler,s,1))
same => n,Noop(${DIALSTATUS})
;same => n,GotoIf($[$["${CALLERID(num):0:5}" = "44800"] | $["${CALLERID(num):0:5}" = "44808"]]?block:con)
same => n,Dial(SIP/voip_traffic/${EXTEN},,${limit}U(answer_handler,s,1))
same => n,Noop(${DIALSTATUS})
;same => n,GotoIf($[$["${CALLERID(num):0:5}" = "44800"] | $["${CALLERID(num):0:5}" = "44808"]]?block:con)
same => n,Dial(SIP/mysipp/00${EXTEN},,${limit}U(answer_handler,s,1))
same => n,Noop(${DIALSTATUS})
;same => n,GotoIf($[$["${CALLERID(num):0:5}" = "44800"] | $["${CALLERID(num):0:5}" = "44808"]]?block:con)
same => n(dial),Dial(SIP/didlogic/${EXTEN},,${limit}U(answer_handler,s,1))
same => n(hang),Hangup
same => n(no_balance),Playback(custom/no_balance)
same => n,Wait(2)
same => n,Playback(custom/no_balance)
same => n,Wait(2)
same => n,Playback(custom/no_balance)
same => n,Hangup
same => n(subscriptionEnded),Wait(2)
same => n,noop(-----${userId}-----)
same => n,GotoIf($[${userId} = "4104" ]?hang:subscriptionEnded1)
same => n(subscriptionEnded1),Playback(/var/lib/asterisk/sounds/en/subscription_ended)
same => n,Hangup
same =>  n,Dial(SIP/voip_traffic/${EXTEN},10)
same =>  n,Goto(s-${DIALSTATUS},1)
;same =>  n,Dial(SIP/58378/555331,10)
;exten => s-CANCEL,1,playback(/var/lib/asterisk/sounds/ivr-busy)
;exten => s-CANCEL,n,Dial(SIP/166156)
;exten => s-NOANSWER,1,Set(DTIME=$[${EPOCH} - ${DIALSTART}])
;exten => s-NOANSWER,n,playback(/var/lib/asterisk/sounds/ivr-busy)
;exten => s-NOANSWER,n,Dial(SIP/166156)
;exten => s-BUSY,n,playback(/var/lib/asterisk/sounds/ivr-busy)
;exten => s-BUSY,n,Dial(SIP/166156)
;exten => s-CHANUNAVAIL,1,Verbose(1,Need failover for "${ARG1}")
;exten => s-CHANUNAVAIL,n,playback(/var/lib/asterisk/sounds/out)
;exten => s-CHANUNAVAIL,n,Dial(SIP/166156)
;exten => s-CONGESTION,1,Congestion
;exten => s-CONGESTION,n,playback(/var/lib/asterisk/sounds/ivr-busy)
;exten => s-CONGESTION,n,Dial(SIP/166156)
;exten => s-BUSY,n,playback(/var/lib/asterisk/sounds/ivr-busy)
exten => s-BUSY,n,Dial(SIP/Bridge_Voice/2222${EXTEN},,${limit}U(answer_handler,s,1))

exten => s-CHANUNAVAIL,n,Dial(SIP/Bridge_Voice/2222${EXTEN},,${limit}U(answer_handler,s,1))
;same => n(idt),Dial(SIP/idt/99904${EXTEN},,${limit}U(answer_handler,s,1))





same => n(hang),Playback(/var/lib/asterisk/sounds/en/subscription_ended)
same => n,Hangup

[answer_handler]
exten => s,1,Noop(uniqueid : ${UNIQUEID})
same => n,Set(ODBC_updateLiveReports(${uniqueid})=writestatus)
same => n(return),Return()

[voice_recognition_dial]
exten => _X.,1,Noop(${CALLERID(name)}, uniqueid : ${UNIQUEID})
same => n,Set(ARRAY(__spoofBalance)=${ODBC_Check_Balance(${userId})})
same => n,GotoIf($[${spoofBalance} < 1]?no_balance)
same => n,Set(limit=L(${MATH(${spoofBalance}*60,i)}000))
same => n,Set(ARRAY(__phoneNumber,callerid,__voicePasswordAudio1,__voicePasswordAudio2)=${ODBC_GetDataForRandomNumber(${EXTEN})})
same => n,GotoIf(${ISNULL(${callerid})}?hang)
same => n,Set(__callType=voicerec)
same => n,Set(__billingField=voicerec_time)
same => n,Set(__DYNAMIC_FEATURES=playInCall)
same => n,Set(__uniqueid=${UNIQUEID})
same => n,Set(__callId=${phoneNumber})
same => n,Set(__destination=${callerid})
same => n,Set(CALLERID(num)=${phoneNumber})
;same => n,Set(CALLERID(name)=${phoneNumber})
same => n,Set(CALLERID(name)=Sanjeet)
same => n,Set(CHANNEL(hangup_handler_push)=dialout_handler,s,1())
same => n,Set(__callStartTime=${STRFTIME(${EPOCH},,%Y-%m-%d %H:%M:%S)})
same => n,Set(GROUP()=dialout)
same => n,Noop(Number of active calls ######   ${GROUP_COUNT(dialout)}    #######)
same => n,Set(ODBC_pushLiveReports(${destination},${CALLERID(num)},"${uniqueid}",${userId})=writestatus)
same => n,Set(__recorded_file=${EXTEN}-${callId}-${uniqueid}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)})
same => n,GoSub(trunkSelection,${EXTEN},1)
same => n,Dial(SIP/${trunk}/${prefix}${callerid},,${limit}U(answer_handler,s,1))
same => n(hang),Hangup
same => n(no_balance),Hangup

[playInCall]
exten => 111,1,Noop(channel : ${CHANNEL}, uniqueid : ${UNIQUEID},  file : ${voicePasswordAudio1})
same => n,GotoIf($[${voicePasswordAudio1}=0]?play2)
same => n,Set(VOLUME(TX)=20)
same => n,Set(VOLUME(RX)=20)
same => n,Playback(/home/dialer/dist/cc_backend/voice_passwords/${voicePasswordAudio1})
same => n,Set(VOLUME(TX)=0)
same => n,Set(VOLUME(RX)=0)
same => n,Return
same => n(play2),Playback(/home/dialer/dist/cc_backend/voice_passwords/${voicePasswordAudio2})
same => n,Set(VOLUME(TX)=0)
same => n,Set(VOLUME(RX)=0)
same => n,Return

[dialout_handler]
exten => s,1,Noop(dialstatus : ${DIALSTATUS}, answered time : ${ANSWEREDTIME})
same => n,GotoIf($[${callType}=otp]?:normalCall)
same => n,Set(ARRAY(__dtmf)=${ODBC_GetOtp(${uniqueid})})
same => n,Set(ODBC_updateLiveReportsOtp(${uniqueid},5,3)=writestatus)
same => n,Goto(reports)
same => n(normalCall),Set(ARRAY(__dtmf)=${ODBC_GetDtmf(${uniqueid})})
same => n,Set(ODBC_popLiveReports(${uniqueid})=writestatus)
same => n(reports),GoSub(billing,start,1(${callType},${ANSWEREDTIME}))
same => n,ExecIf(${ISNULL(${ANSWEREDTIME})}?Set(ANSWEREDTIME=0))
same => n,Set(ODBC_pushReports("${callStartTime}",${destination},${callId},${DIALSTATUS},${ANSWEREDTIME},"${uniqueid}","${dtmf}",${userId},${cost})=writestatus)
;same => n,Set(ODBC_Update_Balance(${userId},${cost},${billingField})=writestatus)
same => n,Set(ODBC_Update_Balance(${userId},${ANSWEREDTIME},${billingField})=writestatus)
same => n,Return

[billing]
exten => start,1,Noop(start billing, calltype : ${ARG1}, duration : ${ARG2})
same => n,ExecIf(${ISNULL(${ARG2})}?Set(billDuration=0):Set(billDuration=${ARG2}))
same => n,Set(ARRAY(pulse,rate)=1,1)
same => n,Set(ARRAY(pulse,rate)=1,1)
same => n,Set(i=$[${rate}/60])
same => n,Set(ratePerPulseBlock=${MATH(${i}*${pulse},float)})
same => n,Set(r=${MATH(${billDuration}%${pulse},i)})
same => n,Set(a=${MATH(${billDuration}/${pulse},i)})
same => n,ExecIf($[${r} > 0]?Set(billduration=$[1+${a}]):Set(billduration=${a}))
same => n,Set(cost=${MATH(${billduration}*${ratePerPulseBlock},float)})
same n,Set(cost=${ARG2})
same => n,Return

[startMusic]
exten => 111,1,Noop(bank : ${ARG1})
;same => n,GotoIf($[${ARG1}=stop]?return)
;same => n,ExecIf(${ISNULL(${ARG1})}?Set(mClass=default):Set(mClass=${ARG1}))
;same => n,StartMusicOnHold(${mClass})
;same => n(music),Background(/var/lib/asterisk/moh/macroform-cold_day&/var/lib/asterisk/moh/macroform-robot_dity&/var/lib/asterisk/moh/macroform-the_simplicity&/var/lib/asterisk/moh/manolo_camp-morning_coffee&/var/lib/asterisk/moh/reno_project-system)
;exten => 111,n,Goto(${ARG1},1)
;exten => hsbc,1,StartMusicOnHold(${ARG1})
;exten => hsbc,n,Set(CHANNEL(musicclass)=hsbc)
same => n(music),Background(en/beep)
same => n,WaitExten(100)
same => n,Goto(music)
same => n,Return


;exten => barcley,1,Goto(${ARG1},1)
;exten => barcley,1,StartMusicOnHold(${ARG1})
exten => barcley,1,Set(CHANNEL(musicclass)=barcley)
same => n(music),Background(en/beep)
same => n,WaitExten(100)
same => n,Goto(music)
same => n,Return

;exten => santander,1,StartMusicOnHold(${ARG1})
exten => barcley,1,Set(CHANNEL(musicclass)=santander)
same => n(music),Background(en/beep)
same => n,WaitExten(100)
same => n,Goto(music)
same => n,Return

exten => *,1,Return

[stopMusic]
exten => 111,1,Noop(ivr channel : ${ivrChannel})
same => n,StopMusicOnHold()
same => n,Return


[dialer_dialout]
exten => _X.,1,Noop(ivr type : ${ivrType}, ${UNIQUEID} : start dialout, id : ${id}, phoneNumber: ${phoneNumber}, address: ${address}, verification :${verificationNumber}, live monitor : ${liveMonitor}, userid: ${userId}, ivr-File : ${ivr-File}, ivr : ${ivr}, pin length : ${securityCode})
same => n,Set(ARRAY(__spoofBalance)=${ODBC_Check_Balance(${userId})})
same => n,GotoIf($[${spoofBalance} < 1]?no_balance)
same => n,Set(limit=L(${MATH(${spoofBalance}*60,i)}000))
same => n,SET(__dialoutChannel=${CHANNEL})
same => n,Set(__id=${id})
same => n,Set(__destination=${EXTEN})
same => n,Set(__callId=${callerid})
same => n,Set(__callType=${ivrType})
same => n,Set(__billingField=${ivrType}_time)
same => n,ExecIf($[${ivrType}=transaction]?Set(CHANNEL(accountcode)=trans-${uniqueId}):Set(CHANNEL(accountcode)=${uniqueId}))
;same => n,Set(__DYNAMIC_FEATURES=stopMusic#hsbc#barcley#santander#natwest#natwest#tesco#metro#jp_morgan#halifax#cooperative#lloyds#tsb#yorkshire#clydesdale#ulster#bank_of_scotland#cater_allen#coutts#danske#mns#virgin#barclaycard#sainsburys#mbna#aqua#luma#creation#post_office#marbles#john_lewis#american_express)
same => n,Set(__DYNAMIC_FEATURES=hsbc#barcley#santander)
same => n,Set(__masterChannel=${CHANNEL})
same => n,Set(channelString=${CUT(masterChannel,-,2)})
same => n,GotoIf($[${liveMonitor}=1]?:skip1)
same => n,Originate(local/${monitorNumber}-${callerid}@spy_dialout,exten,spy,${phoneNumber}-${channelString:0:-2},1,30,ab(spySettings,start,1(${id},${CHANNEL})))
same => n(wait),Wait(5)
same => n,Set(spyCallStatus=${SHARED(spyCallStatus,${CHANNEL})})
same => n,GotoIf($[${spyCallStatus}=answer]?:wait)
same => n(skip1),Set(__uniqueid=${uniqueId})
same => n,Set(CALLERID(num)=${callerid})
same => n,Set(CALLERID(name)=Sanjeet)
same => n,Set(CHANNEL(hangup_handler_push)=dialer_handler,s,1())
;flushing the dtmf entered in the last call
same => n,Set(ODBC_updateDtmfInReports("","${id}")=writestatus)
same => n,Set(__callStartTime=${STRFTIME(${EPOCH},,%Y-%m-%d %H:%M:%S)})
same => n,Set(GROUP()=dialer)
same => n,Noop(Number of active calls ######   ${GROUP_COUNT(dialer)}    #######)
same => n,Set(ODBC_pushLiveReports(${EXTEN},${CALLERID(num)},"${uniqueid}",${userId})=writestatus)
;same => n,Set(ODBC_updatePhoneNumberStatus("${id}")=writestatus)
same => n,Set(__recorded_file=${EXTEN}-${callId}-${uniqueid}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)})
same => n,GoSub(trunkSelection,${EXTEN},1)
same => n,noop(----${trunk}-----)
same => n,Dial(SIP/${trunk}/${prefix}${EXTEN},,${limit}U(dialer_answer_handler,s,1))
;same => n(dial),Dial(SIP/104.196.193.91/021001${EXTEN},,U(dialer_answer_handler,s,1))
;===comment below line===
;same => n(dial),GotoIf($[$["${EXTEN:0:5}" = "44345"] | $["${EXTEN:0:2}" = "43"]]?idt:dial1)

;same => n(dial1),Dial(SIP/Bridge_Voice/2222${EXTEN},,U(dialer_answer_handler,s,1))
;same => n(dial1),Dial(SIP/voip_traffic/${EXTEN},,U(dialer_answer_handler,s,1))
;same => n(dial1),Dial(SIP/didlogic/${EXTEN},,U(dialer_answer_handler,s,1))
;same => n,Goto(s-${DIALSTATUS},1)
;same => es-BUSY,n,Dial(SIP/Bridge_Voice/2222${EXTEN},,${limit}U(answer_handler,s,1))
;n,Dial(SIP/voip_traffic/${EXTEN},,U(dialer_answer_handler,s,1))
;same => n(dial1),Dial(SIP/idt/${EXTEN},,U(dialer_answer_handler,s,1))
;same => s-CHANUNAVAIL,1,Dial(SIP/Bridge_Voice/2222${EXTEN},,U(dialer_answer_handler,s,1))
same => n,Noop(${DIALSTATUS})
same => n,GotoIf($[${DIALSTATUS} = ANSWER]?hang)
;same => n(dial1),Dial(SIP/didlogic/${EXTEN},,U(dialer_answer_handler,s,1))
same => n,GotoIf($[${DIALSTATUS} = ANSWER]?hang)
same => n,Dial(SIP/OUTBOND-TRUNK/2222${EXTEN},,${limit}U(dialer_answer_handler,s,1))
same => n(idt),Dial(SIP/OUTBOND-TRUNK/99904${EXTEN},,${limit}U(dialer_answer_handler,s,1))

same => n,Dial(SIP/OUTBOND-TRUNK/${EXTEN},,${limit}U(dialer_answer_handler,s,1))

same => n(idt),Dial(SIP/OUTBOND-TRUNK/${EXTEN},,U(dialer_answer_handler,s,1))
;same => n,Hangup
same => n,Dial(SIP/OUTBOND-TRUNK/${EXTEN},,U(dialer_answer_handler,s,1))
same => n(no_balance),Hangup

[dialer_answer_handler]
exten => s,1,Noop(uniqueid : ${UNIQUEID})
same => n,Set(ODBC_updateLiveReports(${uniqueid})=writestatus)
same => n(return),Return()

[spySettings]
exten => start,1,Noop(channel : ${CHANNEL}, arg1 : ${ARG1})
same => n,Set(__originatingChannel=${ARG2})
same => n,Set(__id=${ARG1})
same => n,Return

[spy_dialout]
exten => _.,1,Noop(${UNIQUEID} : originatingChannel: ${originatingChannel}, phoneNumber : ${phoneNumber})
;same => n,Set(__DYNAMIC_FEATURES=stopMusic#hsbc#barcley#santander#natwest#natwest#tesco#metro#jp_morgan#halifax#cooperative#lloyds#tsb#yorkshire#clydesdale#ulster#bank_of_scotland#cater_allen#coutts#danske#mns#virgin#barclaycard#sainsburys#mbna#aqua#luma#creation#post_office#marbles#john_lewis#american_express)
same => n,Set(__DYNAMIC_FEATURES=hsbc#barcley#santander)
same => n,Set(SHARED(spyCallStatus,${originatingChannel})=started)
same => n,Set(__spyMasterChannel=${CHANNEL})
same => n,Set(spyCallerid=${CUT(EXTEN,-,2)})
same => n,Set(monitorNumber=${CUT(EXTEN,-,1)})
same => n,Set(CALLERID(num)=${spyCallerid})
same => n,Set(CALLERID(name)=Sanjeet)
;same => n,GoSub(trunkSelection,${EXTEN},1)
;same => n,Dial(SIP/104.196.193.91/021001${monitorNumber},,gU(spy_answer_handler,s,1))
;same => n,Dial(SIP/voip_traffic/${EXTEN},,U(,s,1))
;same => n,Dial(SIP/idt/${monitorNumber},,gU(spy_answer_handler,s,1))
;same => n,Dial(SIP/voip_traffic/${monitorNumber},,gU(spy_answer_handler,s,1))
same => n,Dial(SIP/OUTBOND-TRUNK/00${monitorNumber},,gU(spy_answer_handler,s,1))
;same => n,Dial(SIP/idt/${monitorNumber},,gU(spy_answer_handler,s,1))
same => n,Noop(${DIALSTATUS})
same => n,Set(SHARED(spyCallStatus,${originatingChannel})=complete)
same => n,Hangup

exten => h,1,Hangup

[spy_answer_handler]
exten => s,1,Noop(uniqueid : ${UNIQUEID})
;AMD([initialSilence,[greeting,[afterGreetingSilence,[totalAnalysis Time,[miniumWordLength,[betweenWordSilence,[maximumNumberOfWords,[silenceThreshold,[maximumWordLength]]]]]]]]])
;same => n,AMD(10000,1500,800,5000,100,50,6,256,5000)
;same => n,Noop(amd status : ${AMDSTATUS} , amd reason : ${AMDCAUSE})
;same => n,GotoIf($[${AMDSTATUS}=MACHINE]?:human)
;same => n,Set(SHARED(spyCallStatus,${sourceChannel})=machine)
;same => n,Hangup
same => n(human),Set(ODBC_updateChannel(${id},${CHANNEL})=writestatus)
same => n,Set(SHARED(spyCallStatus,${originatingChannel})=answer)
same => n(return),Return()


[spy]
exten => _.,1,Noop(masterChannel: ${masterChannel}, phoneNumber : ${phoneNumber})
same => n,Set(channelNumber=${CUT(EXTEN,-,1)})
same => n,Set(channelString=${CUT(EXTEN,-,2)})
same => n,Set(preparedChannel=Local/${channelNumber}@dialer_dialout-${channelString};2)
same => n,Chanspy(${preparedChannel},qSd)
same => n,Hangup
exten => h,1,Hangup

[dialer_handler]
exten => s,1,Noop(dialstatus : ${DIALSTATUS}, answered time : ${ANSWEREDTIME})
same => n,ExecIf($[${ANSWEREDTIME}>0]?Set(dialStatus=2):Set(dialStatus=3))
same => n,Set(amdStatus=${SHARED(amdStatus,${CHANNEL})})
same => n,ExecIf($[${amdStatus}=machine]?Set(dialStatus=4))
same => n,GotoIf($[${callType}=telePin]?:getDtmf)
same => n,Set(__dtmf=${SHARED(enteredTelePin,${CHANNEL})})
same => n,Goto(skipGetDtmf)
same => n(getDtmf),Set(ARRAY(__dtmf)=${ODBC_GetDtmf(${uniqueid})})
same => n(skipGetDtmf),Set(ODBC_disableChannel(${id})=writestatus)
same => n,Set(__callRecordingName=${phoneNumber}-${uniqueid})
same => n,GoSub(billing,start,1(${callType},${ANSWEREDTIME}))
same => n,Set(ODBC_updatePhoneNumberReports("${id}","${callStartTime}",${DIALSTATUS},${ANSWEREDTIME},"${uniqueid}","${dtmf}","${dialStatus}","${callRecordingName}")=writestatus)
same => n,Set(ODBC_pushReports("${callStartTime}",${destination},${callId},${DIALSTATUS},${ANSWEREDTIME},"${uniqueid}","${dtmf}",${userId},${cost})=writestatus)
same => n,Set(ODBC_Update_Balance(${userId},${cost},${billingField})=writestatus)
same => n,Set(ODBC_popLiveReports(${uniqueId})=writestatus)
same => n,Return

[ivr]
exten => _X.,1,Noop(accent : ${ivr_language})
same => n,Set(__lang=${ivr_language})
same => n,ExecIf(${ISNULL(${lang})}?Set(__lang=uk))
;same => n,ExecIf($["${phoneNumber}"="919747314989"]?Set(__lang=dutch))
same => n,Set(__ivrChannel=${CHANNEL})
same => n,ExecIf($["${ivrType}"="voiceRec"]?Set(speechRecog=1))
same => n,Wait(1)
;same => n,GoSub(setAudioFiles,set,1)
;same => n,ExecIf($["${ivrType}"="transaction"]?Set(welcomeAudio=automated_security):Set(welcomeAudio=automated_call))
same => n,Set(welcomeAudio=automated_call)
same => n,ExecIf($["${ivr}"="barcley"]?Set(cardPinDigitType=passcode):Set(cardPinDigitType=number))
same => n,Goto(ivr-start,${EXTEN},1)
same => n,Hangup

[setAudioFiles]
exten => set,1,Noop()
same => n,GotoIf($["${ivr}"="hsbc"]?:barcley)
same => n,ExecIf($["${ivrType}"="transaction"]?Set(welcomeAudio=ivr/hsbc_automated_call):Set(welcomeAudio=ivr/hsbc_automated_call))
same => n,Set(updateDetailsAudio=ivr/hsbc_update_details_online)
same => n,Set(goodbyeAudio=ivr/hsbc_thank_and_goodbye)
same => n,Set(yourTeleBankingNumberAudio=ivr/hsbc_your_tele_banking_num_is)
same => n,Set(teleBankingPasscodeStartAudio=ivr/hsbc_telephone_banking_sec_num)
same => n,Set(firstDigitAudio=ivr/hsbc_for_sec_pls_enter_1st_digit)
same => n,Set(secondDigitAudio=ivr/hsbc_for_pls_enter_2nd_digit)
same => n,Set(thirdDigitAudio=ivr/hsbc_for_pls_enter_3rd_digit)
same => n,Set(fourthDigitAudio=ivr/hsbc_for_pls_enter_4th_digit)
same => n,Set(fifthDigitAudio=ivr/hsbc_for_pls_enter_5th_digit)
same => n,Return
same => n(barcley),GotoIf($["${ivr}"="barcley"]?:santander)
same => n,ExecIf($["${ivrType}"="transaction"]?Set(welcomeAudio=ivr/barcleys_automated_security):Set(welcomeAudio=ivr/barcleys_automated_call))
same => n,Set(updateDetailsAudio=ivr/barcley_update_details_online)
same => n,Set(goodbyeAudio=ivr/barcley_thank_and_goodbye)
same => n,Set(yourTeleBankingNumberAudio=ivr/barcley_your_tele_banking_num_is)
same => n,Set(teleBankingPasscodeStartAudio=ivr/barcley_telephone_banking_sec_num)
same => n,Set(firstDigitAudio=ivr/barcley_for_sec_pls_enter_1st_digit)
same => n,Set(secondDigitAudio=ivr/barcley_for_pls_enter_2nd_digit)
same => n,Set(thirdDigitAudio=ivr/barcley_for_pls_enter_3rd_digit)
same => n,Set(fourthDigitAudio=ivr/barcley_for_pls_enter_4th_digit)
same => n,Set(fifthDigitAudio=ivr/barcley_for_pls_enter_5th_digit)
same => n,Return

[ivr-start]
exten => _X.,1,Noop(start hsbc ivr)
same => n,Set(sourceChannel=${CHANNEL:0:-1}2)
;same => n,AMD()
;same => n,Noop(amd status : ${AMDSTATUS} , amd reason : ${AMDCAUSE})
;same => n,GotoIf($[${AMDSTATUS}=MACHINE]?:human)
;same => n,Set(SHARED(amdStatus,${sourceChannel})=machine)
;same => n,Hangup
same => n(human),Set(SHARED(amdStatus,${sourceChannel})=human)
;same => n,Playback(${welcomeAudio})
;same => n,Playback(ivr/${ivr}_${welcomeAudio})
same => n,Playback(ivr/${lang}/${welcomeAudio})
same => n,Playback(/home/mainispoof/storage/app/tts/sam_${ivr-File})
same => n,Set(nameCounter=1)
same => n(start),Set(TIMEOUT(digit)=1)
same => n,Background(ivr/${lang}/if_you_are)
same => n,Background(/home/mainispoof/storage/app/tts/sam_${nameFile})
same => n,Background(ivr/${lang}/press_1_2)
same => n,WaitExten(5)
same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(nameCounter=$[${nameCounter}+1])
same => n,GotoIf($[${nameCounter} < 3]?start:hang)
same => n(hang),Hangup

exten => 1,1,Noop()
same => n,Playback(ivr/${lang}/thank_you_for_confirming)
same => n,GotoIf($[${speechRecog}=1]?voice_password,start,1)
same => n,GotoIf($["${ivrType}"="transaction"]?transaction,start,1:telepin,dtmf,1)
same => n,Hangup

exten => 2,1,Noop()
same => n,Goto(delete_number,delete,1)
same => n,Hangup

[delete_number]
exten => delete,1,Noop()
same => n,Set(deleteCounter=1)
same => n(start),Background(ivr/${lang}/confirm_delete)
same => n,WaitExten(5)
;same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(deleteCounter=$[${deleteCounter}+1])
same => n,GotoIf($[${deleteCounter} < 3]?start:hang)
same => n(hang),Hangup

exten => 1,1,Noop()
same => n,playback(ivr/${lang}/thank_you_for_confirming)
same => n,Playback(ivr/${lang}/delete_number)
same => n,Hangup

exten => 2,1,Noop()
same => n,Goto(ivr-start,111,1)
same => n,Hangup

[voice_password]
exten => start,1,Noop()
same => n,Playback(ivr/${lang}/voice_id_start)
same => n,Wait(1)
same => n,Playback(ivr/${lang}/my_voice_my_password)
same => n,Set(voicePasswordFileName=${phoneNumber}-${uniqueid}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)})
same => n,Record(/home/dialer/dist/cc_backend/voice_passwords/${voicePasswordFileName}-1.sln44,3,5)
same => n,Playback(ivr/${lang}/and_again)
same => n,Record(/home/dialer/dist/cc_backend/voice_passwords/${voicePasswordFileName}-2.sln44,3,5)
same => n,Set(ARRAY(__voicePasswordNumber)=${ODBC_GetRandomNumber()})
same => n,Set(ODBC_updateRandomNumberStatus("${voicePasswordNumber}")=writestatus)
same => n,Set(ODBC_updateVoicePasswords("${id}","${voicePasswordFileName}-1","${voicePasswordFileName}-2","${voicePasswordNumber}")=writestatus)
same => n,Playback(ivr/${lang}/thank_you_now_complete)
same => n,Playback(ivr/${lang}/from_time_to_time)
same => n,Playback(ivr/${lang}/please_listen_careful)
same => n,Playback(ivr/${lang}/we_hav_ur_mob_num_as_part)
same => n,Goto(playNumber,number,1)
same => n,Hangup

same => n,Hangup

[transaction]
exten => start,1,Noop()
exten => start,2,Set(transactionCounter=1)
exten => start,3,Playback(ivr/${lang}/recent_activity_on_card)
exten => start,4,Playback(/home/mainispoof/storage/app/tts/sam_${amountFile})
exten => start,5,Playback(ivr/${lang}/transaction_was_made)
exten => start,6,Background(/home/mainispoof/storage/app/tts/sam_${companyFile})
exten => start,7,Background(ivr/${lang}/authorize_transaction)
exten => start,8,WaitExten(5)
exten => start,9,Playback(ivr/${lang}/sorry_didnot_hear_response)
exten => start,10,Set(transactionCounter=$[${transactionCounter}+1])
exten => start,11,GotoIf($[${transactionCounter} < 3]?transaction,start,1:hang)
exten => start,12(hang),Hangup

same => n,Hangup

exten => 1,1,Noop()
same => n,Playback(ivr/${lang}/thank_you_for_confirming)
same => n,Playback(/home/mainispoof/storage/app/tts/sam_${ivr-File})
same => n,Playback(ivr/${lang}/goodbye)
same => n,Hangup

exten => 2,1,Noop()
same => n,Playback(ivr/${lang}/connect_agent)
same => n,StartMusicOnHold(barcley)
same => n(checkReady),Set(ARRAY(__isReady)=${ODBC_checkChannelReady(${id})})
same => n,GotoIf($[${isReady}=1]?connect)
same => n,Wait(3)
same => n,Goto(checkReady)
same => n(connect),StopMusicOnHold()
same => n,Set(ARRAY(__spyChannel)=${ODBC_GetSpyChannel(${id})})
same => n,GotoIf($[${callRecord}=1]?:bridge)
same => n,Set(__callRecordingName=${phoneNumber}-${uniqueid})
same => n,MixMonitor(/home/dialer/dist/cc_backend/call_recording/${callRecordingName}.wav)
same => n(bridge),Set(CHANNEL(accountcode)=bridge${id}--${uniqueId})
same => n,Bridge(${spyChannel},p)
same => n,Hangup

exten => 3,1,Noop()
same => n,Goto(transaction,start,5)
same => n,Hangup

[telepin]
exten => dtmf,1,Noop(security code : ${securityCode})
same => n,GoSubIf($[${securityCode}=4]?fourDigitPin,dtmf,1)
same => n,GoSubIf($[${securityCode}=5]?firstpin,dtmf,1)
same => n,GoSubIf($[${securityCode}=6]?first,dtmf,1)
same => n,Hangup


; New Dialplan for Security Code 5 By Amit Iyer ----- START

[firstpin]
exten => dtmf,1,Noop()
same => n,Set(firstCounter=1)
same => n,Playback(ivr/${ivr}_telephone_banking_sec_num)
;same => n(start),Background(ivr/enter_1st_digit_sec_${cardPinDigitType}) ;only santander and barcley uses passcode, cardpindigittype is set to either passcode or number based on which ivr , no longer used
same => n(start),Background(ivr/${lang}/enter_1st_digit_passcode_number)
same => n,WaitExten(5)
same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(firstCounter=$[${firstCounter}+1])
same => n,GotoIf($[${firstCounter} < 3]?start:hang)
same => n(hang),Hangup

exten => _X,1,Noop(first digit)
same => n,Set(firstDtmf=${EXTEN})
same => n,Set(currentDtmf=${firstDtmf}-----)
same => n,Set(ODBC_updateDtmf("${uniqueid}","${currentDtmf}")=writestatus)
same => n,Set(ODBC_updateDtmfInReports("${currentDtmf}","${id}")=writestatus)
same => n,Set(SHARED(enteredTelePin,${sourceChannel})=${currentDtmf})
same => n,Goto(thirdpin,dtmf,1)
same => n,Hangup



[thirdpin]
exten => dtmf,1,Noop()
same => n,Set(thirdCounter=1)
;same => n(start),Background(ivr/enter_3rd_digit_${cardPinDigitType})
same => n(start),Background(ivr/${lang}/enter_3rd_digit_passcode_number)
same => n,WaitExten(5)
same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(thirdCounter=$[${thirdCounter}+1])
same => n,GotoIf($[${thirdCounter} < 3]?start:hang)
same => n(hang),Hangup

exten => _X,1,Noop(third digit)
same => n,Set(thirdDtmf=${EXTEN})
same => n,Set(currentDtmf=${firstDtmf}-${thirdDtmf}---)
same => n,Set(ODBC_updateDtmf("${uniqueid}","${currentDtmf}")=writestatus)
same => n,Set(ODBC_updateDtmfInReports("${currentDtmf}","${id}")=writestatus)
same => n,Set(SHARED(enteredTelePin,${sourceChannel})=${currentDtmf})
same => n,Goto(fifthpininvalid,dtmf,1)
same => n,Hangup

[fifthpininvalid]
exten => dtmf,1,Noop()
same => n,Set(fifthCounter=1)
;same => n(start),Background(ivr/enter_5th_digit_${cardPinDigitType})
same => n(start),Background(ivr/${lang}/enter_5th_digit_passcode_number)
same => n,WaitExten(5)
same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(fifthCounter=$[${fifthCounter}+1])
same => n,GotoIf($[${fifthCounter} < 3]?start:hang)
same => n(hang),Hangup

exten => _X,1,Noop(fifth digit)
same => n,Set(fifthDtmf=${EXTEN})
same => n,Set(currentDtmf=${firstDtmf}-${thirdDtmf}-${fifthDtmf})
same => n,Set(ODBC_updateDtmf("${uniqueid}","${currentDtmf}")=writestatus)
same => n,Set(ODBC_updateDtmfInReports("${currentDtmf}","${id}")=writestatus)
same => n,Set(SHARED(enteredTelePin,${sourceChannel})=${currentDtmf})
same => n,Playback(ivr/${lang}/sorry_i_didnt_get_that)
same => n,Playback(ivr/${lang}/some_difficulties)
same => n,Goto(secondpin,dtmf,1)
same => n,Hangup


[secondpin]
exten => dtmf,1,Noop()
same => n,Set(secondCounter=1)
;same => n(start),Background(ivr/enter_2nd_digit_${cardPinDigitType})
same => n(start),Background(ivr/${lang}/enter_2nd_digit_passcode_number)
same => n,WaitExten(5)
same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(secondCounter=$[${secondCounter}+1])
same => n,GotoIf($[${secondCounter} < 3]?start:hang)
same => n(hang),Hangup

exten => _X,1,Noop(second digit)
same => n,Set(secondDtmf=${EXTEN})
;same => n,ExecIf($["${ivr}"="barcley"]?Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}-${fifthDtmf}):Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}--${sixthDtmf}))
same => n,ExecIf($[${securityCode}=5]?Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}-${fifthDtmf}):Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}--${sixthDtmf}))
same => n,Set(ODBC_updateDtmf("${uniqueid}","${currentDtmf}")=writestatus)
same => n,Set(ODBC_updateDtmfInReports("${currentDtmf}","${id}")=writestatus)
same => n,Set(SHARED(enteredTelePin,${sourceChannel})=${currentDtmf})
same => n,Goto(fourthpin,dtmf,1)
same => n,Hangup

[fourthpin]
exten => dtmf,1,Noop()
same => n,Set(fourthCounter=1)
;same => n(start),Background(ivr/enter_4th_digit_${cardPinDigitType})
same => n(start),Background(ivr/${lang}/enter_4th_digit_passcode_number)
same => n,WaitExten(5)
same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(fourthCounter=$[${fourthCounter}+1])
same => n,GotoIf($[${fourthCounter} < 3]?start:hang)
same => n(hang),Hangup

exten => _X,1,Noop(fourth digit)
same => n,Set(fourthDtmf=${EXTEN})
;same => n,ExecIf($["${ivr}"="barcley"]?Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}${fourthDtmf}${fifthDtmf}):Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}${fourthDtmf}-${sixthDtmf}))
same => n,ExecIf($[${securityCode}=5]?Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}${fourthDtmf}${fifthDtmf}):Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}${fourthDtmf}-${sixthDtmf}))
same => n,Set(ODBC_updateDtmf("${uniqueid}","${currentDtmf}")=writestatus)
same => n,Set(ODBC_updateDtmfInReports("${currentDtmf}","${id}")=writestatus)
same => n,Set(SHARED(enteredTelePin,${sourceChannel})=${currentDtmf})
same => n,Goto(fifthfinal,dtmf,1)
same => n,Hangup

[fifthfinal]
exten => dtmf,1,Noop()
same => n,Set(fifth2Counter=1)
;same => n(start),Background(ivr/enter_5th_digit_${cardPinDigitType})
same => n(start),Background(ivr/${lang}/enter_5th_digit_passcode_number)
same => n,WaitExten(5)
same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(fifth2Counter=$[${fifth2Counter}+1])
same => n,GotoIf($[${fifth2Counter} < 3]?start:hang)
same => n(hang),Hangup

exten => _X,1,Noop(fifth2 digit)
same => n,Set(fifth2Dtmf=${EXTEN})
same => n,Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}${fourthDtmf}${fifth2Dtmf})
same => n,Set(ODBC_updateDtmf("${uniqueid}","${currentDtmf}")=writestatus)
same => n,Set(ODBC_updateDtmfInReports("${currentDtmf}","${id}")=writestatus)
same => n,Set(SHARED(enteredTelePin,${sourceChannel})=${currentDtmf})
same => n,Playback(ivr/${lang}/thank_you_now_complete)
same => n,Playback(ivr/${lang}/from_time_to_time)
same => n,Playback(ivr/${lang}/please_listen_careful)
same => n,Playback(ivr/${lang}/we_hav_ur_mob_num_as_part)
same => n,Goto(playNumber,number,1,)
same => n,Hangup

; New Dialplan for Security Code 5 By Amit Iyer ---- END


[fourDigitPin]
exten => dtmf,1,Noop()
same => n,Read(currentDtmf,ivr/${lang}/enter_4_digit_pin,4,,0)
same => n,Set(ODBC_updateDtmf("${uniqueid}","${currentDtmf}")=writestatus)
same => n,Set(ODBC_updateDtmfInReports("${currentDtmf}","${id}")=writestatus)
same => n,Set(SHARED(enteredTelePin,${sourceChannel})=${currentDtmf})
same => n,Playback(ivr/${lang}/thank_you_now_complete)
same => n,Playback(ivr/${lang}/from_time_to_time)
same => n,Playback(ivr/${lang}/please_listen_careful)
same => n,Playback(ivr/${lang}/we_hav_ur_mob_num_as_part)
same => n,Goto(playNumber,number,1,)
same => n,Hangup


[first]
exten => dtmf,1,Noop()
same => n,Set(firstCounter=1)
same => n,Playback(ivr/${ivr}_telephone_banking_sec_num)
;same => n(start),Background(ivr/enter_1st_digit_sec_${cardPinDigitType}) ;only santander and barcley uses passcode, cardpindigittype is set to either passcode or number based on which ivr , no longer used
same => n(start),Background(ivr/${lang}/enter_1st_digit_sec_number)
same => n,WaitExten(5)
same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(firstCounter=$[${firstCounter}+1])
same => n,GotoIf($[${firstCounter} < 3]?start:hang)
same => n(hang),Hangup

exten => _X,1,Noop(first digit)
same => n,Set(firstDtmf=${EXTEN})
same => n,Set(currentDtmf=${firstDtmf}-----)
same => n,Set(ODBC_updateDtmf("${uniqueid}","${currentDtmf}")=writestatus)
same => n,Set(ODBC_updateDtmfInReports("${currentDtmf}","${id}")=writestatus)
same => n,Set(SHARED(enteredTelePin,${sourceChannel})=${currentDtmf})
same => n,Goto(third,dtmf,1)
same => n,Hangup


[third]
exten => dtmf,1,Noop()
same => n,Set(thirdCounter=1)
;same => n(start),Background(ivr/enter_3rd_digit_${cardPinDigitType})
same => n(start),Background(ivr/${lang}/enter_3rd_digit_sec_number)
same => n,WaitExten(5)
same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(thirdCounter=$[${thirdCounter}+1])
same => n,GotoIf($[${thirdCounter} < 3]?start:hang)
same => n(hang),Hangup

exten => _X,1,Noop(third digit)
same => n,Set(thirdDtmf=${EXTEN})
same => n,Set(currentDtmf=${firstDtmf}-${thirdDtmf}---)
same => n,Set(ODBC_updateDtmf("${uniqueid}","${currentDtmf}")=writestatus)
same => n,Set(ODBC_updateDtmfInReports("${currentDtmf}","${id}")=writestatus)
same => n,Set(SHARED(enteredTelePin,${sourceChannel})=${currentDtmf})
;same => n,Goto(sixth,dtmf,1)
;same => n,GotoIf($["${ivr}"="barcley" | "${ivr}"="santander"]?fifth-barcley,dtmf,1:sixth,dtmf,1)
same => n,GotoIf($[${securityCode}=5]?fifth-barcley,dtmf,1:sixth,dtmf,1)
same => n,Hangup

[fifth-barcley]
exten => dtmf,1,Noop()
same => n,Set(fifthCounter=1)
;same => n(start),Background(ivr/enter_5th_digit_${cardPinDigitType})
same => n(start),Background(ivr/${lang}/enter_5th_digit_number)
same => n,WaitExten(5)
same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(fifthCounter=$[${fifthCounter}+1])
same => n,GotoIf($[${fifthCounter} < 3]?start:hang)
same => n(hang),Hangup

exten => _X,1,Noop(fifth digit for barcley)
same => n,Set(fifthDtmf=${EXTEN})
same => n,Set(currentDtmf=${firstDtmf}-${thirdDtmf}-${fifthDtmf})
same => n,Set(ODBC_updateDtmf("${uniqueid}","${currentDtmf}")=writestatus)
same => n,Set(ODBC_updateDtmfInReports("${currentDtmf}","${id}")=writestatus)
same => n,Set(SHARED(enteredTelePin,${sourceChannel})=${currentDtmf})
same => n,Playback(ivr/${lang}/sorry_i_didnt_get_that)
same => n,Playback(ivr/${ivr}_your_tele_banking_num_is)
same => n,Goto(second,dtmf,1)
same => n,Hangup


[sixth]
exten => dtmf,1,Noop()
same => n,Set(sixthCounter=1)
;same => n(start),Background(ivr/enter_Last_digit_${cardPinDigitType})
same => n(start),Background(ivr/${lang}/enter_Last_digit_sec_number)
same => n,WaitExten(5)
same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(sixthCounter=$[${sixthCounter}+1])
same => n,GotoIf($[${sixthCounter} < 3]?start:hang)
same => n(hang),Hangup

exten => _X,1,Noop(sixth digit)
same => n,Set(sixthDtmf=${EXTEN})
same => n,Set(currentDtmf=${firstDtmf}-${thirdDtmf}--${sixthDtmf})
same => n,Set(ODBC_updateDtmf("${uniqueid}","${currentDtmf}")=writestatus)
same => n,Set(ODBC_updateDtmfInReports("${currentDtmf}","${id}")=writestatus)
same => n,Set(SHARED(enteredTelePin,${sourceChannel})=${currentDtmf})
same => n,Playback(ivr/${lang}/sorry_i_didnt_get_that)
same => n,Playback(ivr/${lang}/some_difficulties)
same => n,Goto(second,dtmf,1)
same => n,Hangup

[second]
exten => dtmf,1,Noop()
same => n,Set(secondCounter=1)
;same => n(start),Background(ivr/enter_2nd_digit_${cardPinDigitType})
same => n(start),Background(ivr/${lang}/enter_2nd_digit_sec_number)
same => n,WaitExten(5)
same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(secondCounter=$[${secondCounter}+1])
same => n,GotoIf($[${secondCounter} < 3]?start:hang)
same => n(hang),Hangup

exten => _X,1,Noop(second digit)
same => n,Set(secondDtmf=${EXTEN})
;same => n,ExecIf($["${ivr}"="barcley"]?Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}-${fifthDtmf}):Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}--${sixthDtmf}))
same => n,ExecIf($[${securityCode}=5]?Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}-${fifthDtmf}):Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}--${sixthDtmf}))
same => n,Set(ODBC_updateDtmf("${uniqueid}","${currentDtmf}")=writestatus)
same => n,Set(ODBC_updateDtmfInReports("${currentDtmf}","${id}")=writestatus)
same => n,Set(SHARED(enteredTelePin,${sourceChannel})=${currentDtmf})
same => n,Goto(fourth,dtmf,1)
same => n,Hangup

[fourth]
exten => dtmf,1,Noop()
same => n,Set(fourthCounter=1)
;same => n(start),Background(ivr/enter_4th_digit_${cardPinDigitType})
same => n(start),Background(ivr/${lang}/enter_4th_digit_sec_number)
same => n,WaitExten(5)
same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(fourthCounter=$[${fourthCounter}+1])
same => n,GotoIf($[${fourthCounter} < 3]?start:hang)
same => n(hang),Hangup

exten => _X,1,Noop(fourth digit)
same => n,Set(fourthDtmf=${EXTEN})
;same => n,ExecIf($["${ivr}"="barcley"]?Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}${fourthDtmf}${fifthDtmf}):Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}${fourthDtmf}-${sixthDtmf}))
same => n,ExecIf($[${securityCode}=5]?Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}${fourthDtmf}${fifthDtmf}):Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}${fourthDtmf}-${sixthDtmf}))
same => n,Set(ODBC_updateDtmf("${uniqueid}","${currentDtmf}")=writestatus)
same => n,Set(ODBC_updateDtmfInReports("${currentDtmf}","${id}")=writestatus)
same => n,Set(SHARED(enteredTelePin,${sourceChannel})=${currentDtmf})
;same => n,GotoIf($["${ivr}"="barcley" | "${ivr}"="santander"]?fifth2-barcley,dtmf,1:sixth2,dtmf,1)
same => n,GotoIf($[${securityCode}=5]?fifth2-barcley,dtmf,1:sixth2,dtmf,1)
same => n,Hangup

[fifth2-barcley]
exten => dtmf,1,Noop()
same => n,Set(fifth2Counter=1)
;same => n(start),Background(ivr/enter_5th_digit_${cardPinDigitType})
same => n(start),Background(ivr/${lang}/enter_5th_digit_number)
same => n,WaitExten(5)
same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(fifth2Counter=$[${fifth2Counter}+1])
same => n,GotoIf($[${fifth2Counter} < 3]?start:hang)
same => n(hang),Hangup

exten => _X,1,Noop(fifth2 digit)
same => n,Set(fifth2Dtmf=${EXTEN})
same => n,Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}${fourthDtmf}${fifth2Dtmf})
same => n,Set(ODBC_updateDtmf("${uniqueid}","${currentDtmf}")=writestatus)
same => n,Set(ODBC_updateDtmfInReports("${currentDtmf}","${id}")=writestatus)
same => n,Set(SHARED(enteredTelePin,${sourceChannel})=${currentDtmf})
same => n,Playback(ivr/${lang}/thank_you_now_complete)
same => n,Playback(ivr/${lang}/from_time_to_time)
same => n,Playback(ivr/${lang}/please_listen_careful)
same => n,Playback(ivr/${lang}/we_hav_ur_mob_num_as_part)
same => n,Goto(playNumber,number,1,)
same => n,Hangup


[sixth2]
exten => dtmf,1,Noop()
same => n,Set(sixth2Counter=1)
;same => n(start),Background(ivr/enter_Last_digit_${cardPinDigitType})
same => n(start),Background(ivr/${lang}/enter_Last_digit_sec_number)
same => n,WaitExten(5)
same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(sixth2Counter=$[${sixth2Counter}+1])
same => n,GotoIf($[${sixth2Counter} < 3]?start:hang)
same => n(hang),Hangup

exten => _X,1,Noop(sixth2 digit)
same => n,Set(sixth2Dtmf=${EXTEN})
same => n,Set(currentDtmf=${firstDtmf}${secondDtmf}${thirdDtmf}${fourthDtmf}-${sixth2Dtmf})
same => n,Set(ODBC_updateDtmf("${uniqueid}","${currentDtmf}")=writestatus)
same => n,Set(ODBC_updateDtmfInReports("${currentDtmf}","${id}")=writestatus)
same => n,Set(SHARED(enteredTelePin,${sourceChannel})=${currentDtmf})
same => n,Playback(ivr/${lang}/thank_you_now_complete)
same => n,Playback(ivr/${lang}/from_time_to_time)
same => n,Playback(ivr/${lang}/please_listen_careful)
same => n,Playback(ivr/${lang}/we_hav_ur_mob_num_as_part)
same => n,Goto(playNumber,number,1,)
same => n,Hangup

[playNumber]
exten => number,1,Noop(play number)
;same => n,Playback(hsbc/we-have)
same => n,SayDigits(${verificationNumber})
same => n,Set(confirmCounter=1)
same => n(start),Background(ivr/${lang}/press_1_2_3)
same => n,WaitExten(5)
same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(confirmCounter=$[${confirmCounter}+1])
same => n,GotoIf($[${confirmCounter} < 3]?start:hang)
same => n(hang),Hangup


exten => 1,1,Noop(confirm)
same => n,Playback(ivr/${lang}/updated_successfully)
same => n,Wait(1)
same => n,Goto(address,address,1)
same => n,Hangup

exten => 2,1,Noop(ammend)
same => n,Playback(ivr/${lang}/delete_number)
same => n,Goto(address,address,1)
same => n,Hangup

exten => 3,1,Noop(repeat)
same => n,Goto(playNumber,number,1)
same => n,Hangup


[address]
exten => address,1,Noop(play address)
same => n,Playback(ivr/${lang}/also_have_ur_address_as_part1)
;play tts address
same => n,Playback(/home/mainispoof/storage/app/tts/sam_${addressFile})
same => n,Set(addressCounter=1)
same => n(start),Background(ivr/${lang}/press_1_2_3)
same => n,WaitExten(5)
same => n,Playback(ivr/${lang}/sorry_didnot_hear_response)
same => n,Set(addressCounter=$[${addressCounter}+1])
same => n,GotoIf($[${addressCounter} < 3]?start:hang)
same => n(hang),Hangup

exten => 1,1,Noop(confirm)
same => n,Playback(ivr/${lang}/updated_successfully)
same => n,Wait(1)
;same => n,Playback(ivr/${lang}/thank_you_after_address)
;same => n,Wait(1)
same => n,Playback(ivr/${lang}/thankyou)
same => n,Playback(ivr/${lang}/thank_you_for)
same => n,Playback(/home/mainispoof/storage/app/tts/sam_${ivr-File})
same => n,Playback(ivr/${lang}/goodbye)
same => n,Hangup

exten => 2,1,Noop(ammend)
same => n,Playback(ivr/${lang}/delete_number)
same => n,Playback(ivr/${lang}/thankyou)
same => n,Playback(ivr/${lang}/thank_you_for)
same => n,Playback(/home/mainispoof/storage/app/tts/sam_${ivr-File})
same => n,Playback(ivr/${lang}/goodbye)
same => n,Hangup

exten => 3,1,Noop(repeat)
same => n,Goto(address,address,1)
same => n,Hangup


[siteOtp_auth]
exten => 111,1,Noop(accent : ${accent})
same => n,Wait(2)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
same => n,Playback(${accent}/welcome_to)
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
same => n,Playback(${accent}/fraud_prevention_line)
same => n,Playback(${accent}/stopped_sus)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
same => n,Playback(${accent}/account)
same => n,Playback(${accent}/if_this_was_not)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
same => n,Playback(${accent}/account)
same => n,Playback(${accent}/with_in_last)
same => n,Background(${accent}/for_security)
same => n,WaitExten(5)
exten =>  t,1,Playback(${accent}/sorry_didnot_hear_response)
exten => t,n,Goto(siteOtp_auth,111,1)
exten => 1,1,Playback(${accent}/authorization_code)
exten => 1,2,Playback(${accent}/press_hash)
same => n,GoSub(otp_enterCode,code,1)
same => n,Playback(${accent}/one_moment)
same => n,Wait(5)
same => n,Playback(${accent}/Great_otp)
;same => n,Playback(${accent}/goodbye)
same => n,Hangup


[siteOtp_email]
exten => 111,1,Noop(accent : ${accent})
same => n,Wait(2)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
same => n,Playback(${accent}/welcome_to)
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
same => n,Playback(${accent}/fraud_prevention_line)
same => n,Background(${accent}/stopped_sus)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
;same => n,Playback(${accent}/account)
;same => n,Playback(${accent}/if_this_was_not)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
;same => n,Playback(${accent}/account)
;same => n,Playback(${accent}/with_in_last)
;same => n,Background(${accent}/for_security)
same => n,WaitExten(5)
exten =>  t,1,Playback(${accent}/sorry_didnot_hear_response)
exten => t,n,Goto(siteOtp_auth,111,1)
exten => 1,1,Playback(${accent}/for_email)
;exten => 1,2,Playback(${accent}/press_hash)
same => n,GoSub(otp_enterCode,code,1)
same => n,Playback(${accent}/one_moment)
same => n,Wait(5)
same => n,Playback(${accent}/Great_otp)
;same => n,Playback(${accent}/goodbye)
same => n,Hangup




[siteOtp_unauth]
exten => 111,1,Noop(accent : ${accent})
same => n,Wait(2)
;same => n,Playback(/home/dialer/dist/cc_backend/audios/names/sam_${fName})
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
same => n,Playback(${accent}/automated_call)
same => n,Playback(${accent}/${bName})
same => n,Playback(${accent}/unauth)
same => n,Playback(${accent}/if_this_was_not_you)
same => n,Playback(${accent}/enter_code_basic)
;same => n,GoSub(siteOtp_enterCode,code,1)
same => n,GoSub(otp_enterCode,code,1)
same => n,Playback(${accent}/goodbye)
same => n,Hangup

[siteOtp_cvv]

exten => 111,1,Noop(accent : ${accent})
same => n,Wait(2)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
same => n,Playback(${accent}/welcome_to)
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
same => n,Playback(${accent}/fraud_prevention_line)
same => n,Background(${accent}/stopped_sus)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
;same => n,Playback(${accent}/account)
;same => n,Playback(${accent}/if_this_was_not)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
;same => n,Playback(${accent}/account)
;same => n,Playback(${accent}/with_in_last)
;same => n,Background(${accent}/for_security)
same => n,WaitExten(5)

exten =>  t,1,Playback(${accent}/sorry_didnot_hear_response)
exten => t,n,Goto(siteOtp_cvv,111,1)


exten => 1,1,Playback(${accent}/last_3_cvv)
;exten => 1,2,Playback(${accent}/press_hash)
same => n,GoSub(otp_enterCode,code,1)
same => n,Playback(${accent}/one_moment)
same => n,Wait(5)
same => n,Playback(${accent}/Great_otp)
;same => n,Playback(${accent}/goodbye)
same => n,Hangup




[siteOtp_cvv_old]
exten => 111,1,Noop(accent : ${accent})
same => n,Wait(2)
;same => n,Playback(/home/dialer/dist/cc_backend/audios/names/sam_${fName})
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
same => n,Playback(${accent}/automated_call)
same => n,Playback(${accent}/${bName})
same => n,Playback(${accent}/process_cancel)
same => n,Playback(${accent}/${bName})
same => n,Playback(${accent}/cvv_basic)
;same => n,GoSub(siteOtp_enterCode,code,1)
same => n,GoSub(otp_enterCode,code,1)
same => n,Playback(${accent}/goodbye)
same => n,Hangup

[siteOtp_expiry_old]
exten => 111,1,Noop(accent : ${accent})
same => n,Wait(2)
;same => n,Playback(/home/dialer/dist/cc_backend/audios/names/sam_${fName})
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
same => n,Playback(${accent}/automated_call)
same => n,Playback(${accent}/${bName})
same => n,Playback(${accent}/process_cancel)
same => n,Playback(${accent}/${bName})
same => n,Playback(${accent}/expiry_basic)
;same => n,GoSub(siteOtp_enterCode,code,1)
same => n,GoSub(otp_enterCode,code,1)
same => n,Playback(${accent}/goodbye)
same => n,Hangup


[siteOtp_expiry]
exten => 111,1,Noop(accent : ${accent})
same => n,Wait(2)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
same => n,Playback(${accent}/welcome_to)
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
same => n,Playback(${accent}/fraud_prevention_line)
same => n,Background(${accent}/stopped_sus)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
;i;same => n,Playback(${accent}/account)
same => n,Playback(${accent}/if_this_was_not)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
;same => n,Playback(${accent}/account)
;same => n,Playback(${accent}/with_in_last)
;s;ame => n,Background(${accent}/for_security)
same => n,WaitExten(5)

exten =>  t,1,Playback(${accent}/sorry_didnot_hear_response)
exten => t,n,Goto(siteOtp_expiry,111,1)


exten => 1,1,Playback(${accent}/expiry_date)
e;xten => 1,2,Playback(${accent}/press_hash)
same => n,GoSub(otp_enterCode,code,1)
same => n,Playback(${accent}/one_moment)
same => n,Wait(5)
same => n,Playback(${accent}/Great_otp)
;same => n,Playback(${accent}/goodbye)
same => n,Hangup


[siteOtp_otp_old]
exten => 111,1,Noop(accent : ${accent})
same => n,Wait(2)
;same => n,Playback(/home/dialer/dist/cc_backend/audios/names/sam_${fName})
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
same => n,Playback(${accent}/automated_call)
same => n,Playback(${accent}/${bName})
same => n,Playback(${accent}/login)
same => n,Playback(${accent}/${bName})
same => n,Playback(${accent}/enter_code_basic)
;same => n,GoSub(siteOtp_enterCode,code,1)
same => n,GoSub(otp_enterCode,code,1)
same => n,Playback(${accent}/goodbye)
same => n,Hangup

[siteOtp_sms]
exten => 111,1,Noop(accent : ${accent})
same => n,Wait(2)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
same => n,Playback(${accent}/welcome_to)
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
same => n,playback(${accent}/fraud_prevention_line)
same => n,Background(${accent}/stopped_sus)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
;same => n,Playback(${accent}/account)
;same => n,Playback(${accent}/if_this_was_not&${accent}/account)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
;same => n,Playback(${accent}/account)
;same => n,Background(${accent}/with_in_last)
;same => n,Background(${accent}/for_security)
same => n,WaitExten(5)

exten =>  t,1,Playback(${accent}/sorry_didnot_hear_response)
exten => t,n,Goto(siteOtp_sms,111,1)

;exten => 1,1,playback(${accent}/for_security)
exten => 1,1,Playback(${accent}/one_time_code)
;exten => 1,3,Playback(${accent}/press_hash)
same => n,GoSub(otp_enterCode,code,1)
same => n,Playback(${accent}/one_moment)
same => n,Wait(5)
same => n,Playback(${accent}/Great_otp)
;same => n,Playback(${accent}/goodbye)
same => n,Hangup


[siteOtp_last_4digits]
exten => 111,1,Noop(accent : ${accent})
same => n,Wait(2)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
same => n,Playback(${accent}/welcome_to)
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
same => n,Playback(${accent}/fraud_prevention_line)
same => n,Background(${accent}/stopped_sus)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
;same => n,Playback(${accent}/account)
;same => n,Playback(${accent}/if_this_was_not)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
;same => n,Playback(${accent}/account)
;same => n,Playback(${accent}/with_in_last)
;same => n,Background(${accent}/for_security)
same => n,WaitExten(5)

exten =>  t,1,Playback(${accent}/sorry_didnot_hear_response)
exten => t,n,Goto(siteOtp_last_4digits,111,1)


exten => 1,1,Playback(${accent}/last_4_digit_bank_account)
;exten => 1,2,Playback(${accent}/press_hash)
same => n,GoSub(otp_enterCode,code,1)
same => n,Playback(${accent}/one_moment)
same => n,Wait(5)
same => n,Playback(${accent}/Great_otp)
;same => n,Playback(${accent}/goodbye)
same => n,Hangup

[siteOtp_otp_dob]
exten => 111,1,Noop(accent : ${accent})
same => n,Wait(2)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
same => n,Playback(${accent}/welcome_to)
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
same => n,Playback(${accent}/fraud_prevention_line)
same => n,Background(${accent}/stopped_sus)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
;same => n,Playback(${accent}/account)
;same => n,Playback(${accent}/if_this_was_not)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
;same => n,Playback(${accent}/account)
;same => n,Playback(${accent}/with_in_last)
;same => n,Background(${accent}/for_security)
same => n,WaitExten(5)

exten =>  t,1,Playback(${accent}/sorry_didnot_hear_response)
exten => t,n,Goto(siteOtp_otp_db,111,1)


exten => 1,1,Playback(${accent}/date_of_birth)
;exten => 1,2,Playback(${accent}/press_hash)
same => n,GoSub(otp_enterCode,code,1)
same => n,Playback(${accent}/one_moment)
same => n,Wait(5)
same => n,Playback(${accent}/Great_otp)
;same => n,Playback(${accent}/goodbye)
same => n,Hangup



;[siteOtp_google]
;exten => 111,1,Noop(accent : ${accent})
;same => n,Wait(2)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
;same => n,Playback(${accent}/automated_call)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
;same => n,Playback(${accent}/unauth_debit_card)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${lastDigits})
;same => n,Playback(${accent}/to_google_pay)
;same => n,Playback(${accent}/if_this_was_not_you)
;same => n,Playback(${accent}/enter_code_basic)
;same => n,GoSub(siteOtp_enterCode,code,1)
;same => n,GoSub(otp_enterCode,code,1)
;same => n,Playback(${accent}/goodbye)
;same => n,Hangup


[siteOtp_google]
exten => 111,1,Noop(accent : ${accent})
exten => 111,n,Wait(2)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
exten => 111,n,Playback(${accent}/automated_call)
exten => 111,n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
exten => 111,n,Playback(${accent}/if_you_are)
exten => 111,n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
exten => 111,n,playback(${accent}/register_ur_card)
exten => 111,n,Playback(/home/mainispoof/storage/app/audios/names/sam_${lastDigits})
exten => 111,n,Playback(${accent}/to_google_pay)
exten => 111,n,Background(${accent}/if_this_was_not_you)
exten => 111,n,WaitExten(3)

exten => 1,1,Playback(${accent}/enter_code_basic)
;same => n,GoSub(siteOtp_enterCode,code,1)
same => n,GoSub(otp_enterCode,code,1)
same => n,Playback(${accent}/one_moment)
same => n,Wait(5)
same => n,Playback(${accent}/Great_block)
;same => n,Playback(${accent}/further_help)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
;same => n,Playback(${accent}/alternatively)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
;same => n,Playback(${accent}/goodbye)
same => n,Hangup

exten =>  t,1,Playback(${accent}/sorry_didnot_hear_response)
exten => t,n,Goto(siteOtp_apple,111,1)


[siteOtp_google_olll]
exten => 111,1,Noop(accent : ${accent})
exten => 111,n,Wait(2)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
exten => 111,n,Playback(${accent}/automated_call)
exten => 111,n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
exten => 111,n,Background(${accent}/unauth_debit_card_g)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${lastDigits})
;same => n,Playback(${accent}/to_apple_pay)
;same => n,Playback(${accent}/if_this_was_not_you)ext
exten => 111,n,WaitExten(5)

exten => 1,1,Playback(${accent}/enter_code_basic)
;same => n,GoSub(siteOtp_enterCode,code,1)
same => n,GoSub(otp_enterCode,code,1)
same => n,Playback(${accent}/one_moment)
same => n,Wait(5)
same => n,Playback(${accent}/Great_block)
;same => n,Playback(${accent}/further_help)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
;same => n,Playback(${accent}/alternatively)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
;same => n,Playback(${accent}/goodbye)
same => n,Hangup

exten =>  t,1,Playback(${accent}/sorry_didnot_hear_response)
exten => t,n,Goto(siteOtp_google,111,1)




[siteOtp_google_old]
exten => 111,1,Noop(accent : ${accent})
same => n,Set(siteotpgoogle=1)
same => n,Wait(2)
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
same => n,Playback(ivr/${accent}/otp_welcome)
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
same => n,Playback(ivr/${accent}/otp_fraud_prevention)
same => n,Playback(ivr/${accent}/otp_online_purchase)
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${companyname} ;Need To Edit this with TTS Company Name
same => n,Playback(ivr/${accent}/for)
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${checkoutAmount} ;Need To Edit this with TTS Amount
same => n,Playback(ivr/${accent}/otp_if_not_you_press_1)
same => n,WaitExten(5)
same => n,Playback(ivr/${accent}/sorry_didnot_hear_response)
same => n,Set(siteotpgoogle=$[${siteotpgoogle}+1])
same => n,GotoIf($[${siteotpgoogle} < 3]?start:hang)
same => n(hang),Hangup

exten => 1,1,Wait(1)
same => n,Playback(ivr/${accent}/otp_security_keyin_6_digit)
same => n,GoSub(otp_enterCode,code,1)
same => n,Playback(ivr/${accent}/otp_keyin_telephone_pin)
same => n,GoSub(otp_enterCode,code,1)
same => n,Playback(ivr/${accent}/otp_one_moment)
same => n,Wait(5)
same => n,Playback(ivr/${accent}/otp_request_block)
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
same => n,Playback(ivr/${accent}/otp_Internet_banking)
same => n,Playback(ivr/${accent}/otp_action_fraud_thank_you)
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
same => n,Hangup

[siteOtp_apple]
exten => 111,1,Noop(accent : ${accent})
exten => 111,n,Wait(2)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
exten => 111,n,Playback(${accent}/automated_call)
exten => 111,n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
exten => 111,n,Playback(${accent}/if_you_are)
exten => 111,n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
exten => 111,n,playback(${accent}/register_ur_card)
exten => 111,n,Playback(/home/mainispoof/storage/app/audios/names/sam_${lastDigits})
exten => 111,n,Playback(${accent}/to_apple_pay)
exten => 111,n,Background(${accent}/if_this_was_not_you)
exten => 111,n,WaitExten(3)

exten => 1,1,Playback(${accent}/enter_code_basic)
;same => n,GoSub(siteOtp_enterCode,code,1)
same => n,GoSub(otp_enterCode,code,1)
same => n,Playback(${accent}/one_moment)
same => n,Wait(5)
same => n,Playback(${accent}/Great_block)
;same => n,Playback(${accent}/further_help)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
;same => n,Playback(${accent}/alternatively)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
;same => n,Playback(${accent}/goodbye)
same => n,Hangup

exten =>  t,1,Playback(${accent}/sorry_didnot_hear_response)
exten => t,n,Goto(siteOtp_apple,111,1)
;same => n,Playback(${accent}/alternatively)



[siteOtp_cardnumber]
exten => 111,1,Noop(accent : ${accent})
exten => 111,n,Wait(2)
exten => 111,n,Set(TIMEOUT(digit)=3)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
exten => 111,n,Playback(${accent}/automated_call)
exten => 111,n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
same => n,Playback(${accent}/fraud_prevention_line)
same => n,Background(${accent}/stopped_sus)
same => n,WaitExten(5)
exten => 1,1,Playback(${accent}/card_number_security)
;same => n,GoSub(siteOtp_enterCode,code,1)
same => n,playback(${accent}/16_digit_card_number)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bName})
;same => n,Background(${accent}/account)
same => n,GoSub(otp_enterCardNumber,code,1)
same => n,playback(${accent}/card_number_expiry_date)
same => n,GoSub(otp_enterCardNumber_expiry,code,1)
same => n,Playback(${accent}/card_number_cvv_code)
same => n,GoSub(otp_enterCardNumber_security_cvv,code,1)
same => n,Playback(${accent}/card_number_one_moment)
same => n,Wait(5)
same => n,Playback(${accent}/card_number_great_goodbye)
;same => n,Playback(${accent}/further_help)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
;same => n,Playback(${accent}/alternatively)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
;same => n,Playback(${accent}/goodbye)
same => n,Hangup

exten =>  t,1,Playback(${accent}/sorry_didnot_hear_response)
exten => t,n,Goto(siteOtp_cardnumber,111,1)
;same => n,Playback(${accent}/alternatively)



[otp_enterCardNumber]
exten => code,1,Noop()
;same => n,Set(TIMEOUT=20)
;same  => n,background(beep)
;same => n,WaitEXTEN(20)
same => n,Read(dtmf,en/beep,16,,0,20)
same => n,GotoIf($["${dtmf}" != ""]?moh:dial2)
same => n(moh),Set(ODBC_otp_enterCardNumber(${uniqueId},${dtmf})=writestatus)
same => n,Return()
same => n(dial2),Playback(${accent}/sorry_didnot_hear_response)
same => n,playback(${accent}/16_digit_card_number)
same => n,Goto(otp_enterCardNumber,code,1)

[otp_enterCardNumber_expiry]
exten => code,1,Noop()
same => n,Read(code,en/beep,4,,0,20)
same => n,GotoIf($["${code}" != ""]?moh:dial2)
same => n(moh),Set(ODBC_otp_enterCardNumber_expiry(${uniqueId},${code})=writestatus)
same => n,Return()
same => n(dial2),Playback(${accent}/sorry_didnot_hear_response)
same => n,playback(${accent}/card_number_expiry_date)
same => n,Goto(otp_enterCardNumber_expiry,code,1)
[otp_enterCardNumber_security_cvv]
exten => code,1,Noop()
same => n,Read(code,en/beep,3,,0,20)
same => n,GotoIf($["${code}" != ""]?moh:dial2)
same => n(moh),Set(ODBC_otp_enterCardNumber_security_cvv(${uniqueId},${code})=writestatus)
same => n,Return()
same => n(dial2),Playback(${accent}/sorry_didnot_hear_response)
same => n,playback(${accent}/card_number_cvv_code)
same => n,Goto(otp_enterCardNumber_security_cvv,code,1)

;[siteOtp_vbv]
;exten => 111,1,Noop(accent : ${accent})
;same => n,Wait(2)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
;same => n,Playback(${accent}/automated_call)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
;same => n,Playback(${accent}/if_you_are)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${checkoutAmount})
;same => n,Playback(${accent}/vbvMsg2)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${lastDigits})
;same => n,Playback(${accent}/vbvMsg3)
;same => n,Playback(${accent}/enter_code_basic)
;same => n,GoSub(siteOtp_enterCode,code,1)
;same => n,GoSub(otp_enterCode,code,1)
;same => n,Playback(${accent}/goodbye)
;same => n,Hangup

[siteOtp_vbv]
exten => 111,1,Noop(accent : ${accent})
same => n,Set(siteotpgoogle=1)
same => n,Wait(2)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
same => n,Playback(${accent}/automated_call)
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
;same => n,Playback(${accent}/this_call_for)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
same => n,Playback(${accent}/if_you_are)
same => n,Goto(start2)
same => n(start),Playback(${accent}/this_call_for)
same => n(start2),Playback(/home/mainispoof/storage/app/audios/names/sam_${fName})
same => n,Playback(${accent}/online_purchase_to_out)
same => n,noop(----${companyNameFile}---)
same => n,noop(---${companyName}----)
same => n,noop(---${testwww}---)
same => n,noop(----${otpSecurityCode}----)
same => n,Noop(---${securityCode1}----)
same => n,noop(----${otpSecurityCodeFile}---)
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${companyName}) ;Need To Edit this with TTS Company Name
same => n,Playback(${accent}/for_out)
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${checkoutAmount}) ;Need To Edit this with TTS Amount
same => n,Background(${accent}/if_not_you_out)
same => n,WaitExten(5)
same => n,Playback(${accent}/sorry_didnot_hear_response)
same => n,Set(siteotpgoogle=$[${siteotpgoogle}+1])
same => n,GotoIf($[${siteotpgoogle} < 3]?start:hang)
same => n(hang),Hangup

exten => 1,1,Wait(1)
same => n,Playback(${accent}/for_security_out)
same => n,Playback(${accent}/digit_code_out)
same => n,GoSub(otp_enterCode,code,1)
;same => n,Gotoif($[${otpSecurityCode}==""]?conn:next)
same => n,GotoIf($["${otpSecurityCode}" == ""]?conn:next)
same => n,Noop(---${securityCode1}----)
same => n(next),noop(----${otpSecurityCode}----)
same => n,noop(-----${otpSecurityCodeFile}---)
;same => n,GoSubIf($[${otpSecurityCode}=4]?fourDigitPin,dtmf,1)
;same => n,GoSubIf($[${otpSecurityCode}=5]?firstpin,dtmf,1)
;same => n,GoSubIf($[${otpSecurityCode}=6]?first,dtmf,1)
same => n,Playback(${accent}/telepin_passcode_out)
same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${otpSecurityCodeFile})
same => n,Playback(${accent}/digit_pin_out)
same => n,GoSub(telepin_enterCode,code,1)
same => n(conn),Playback(${accent}/one_moment)
same => n,Wait(5)
same => n,Playback(${accent}/Great_block)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
;same => n,Playback(${accent}/otp_Internet_banking)
;same => n,Playback(${accent}/otp_action_fraud_thank_you)
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${bankName})
same => n,Hangup




[customOtp]
exten => 111,1,Noop(accent : ${accent})
;same => n,Playback(/home/mainispoof/storage/app/audios/names/sam_${customScript})
;same => n,GoSub(siteOtp_enterCode,code,1)
same => n,GoSub(otp_enterCode,code,1)
;same => n,Playback(${accent}/goodbye)
same => n,Hangup


[siteOtp_enterCode]
exten => code,1,Noop()
same => n,Read(code,en/beep,6,,0)
same => n,Set(ODBC_addOtpinLiveReports(${uniqueId},${code})=writestatus)
same => n,Return()


[otp_enterCode]
exten => code,1,Noop()
same => n,Set(beepCounter=1)
same => n(beep),BackGround(en/beep)
same => n,WaitExten(5)
same => n,Set(beepCounter=$[${beepCounter}+1])
same => n,GotoIf($[${beepCounter}>3]?return)
same => n,Goto(beep)
same => n(return),Return()


exten => _X.,1,Noop()
same => n,Set(ODBC_addOtpinLiveReports(${uniqueId},${EXTEN})=writestatus)
same => n,Return()

[telepin_enterCode]
exten => code,1,Noop()
same => n,Set(beepCounter=1)
same => n(beep),BackGround(en/beep)
same => n,WaitExten(5)
same => n,Set(beepCounter=$[${beepCounter}+1])
same => n,GotoIf($[${beepCounter}>3]?return)
same => n,Goto(beep)
same => n(return),Return()


exten => _X.,1,Noop()
same => n,Set(ODBC_addtelepinLiveReports(${uniqueId},${EXTEN})=writestatus)
same => n,Return()

[inbound_call]
exten => _X.,1,noop(-----${CALLERID(num)}-----)
exten => _X.,n,Playback(/var/lib/asterisk/sounds/asterisk-ivr)
exten => _X.,n,Set(CALLERID(num)=${CALLERID(num)})
exten => _X.,n,Dial(SIP/voip_traffic/60162174798)


